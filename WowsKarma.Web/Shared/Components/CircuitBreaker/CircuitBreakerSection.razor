@inherits ErrorBoundary

@if (CurrentException is null)
{
    @ChildContent
}
else
{
    OnCaughtException?.Invoke(this, CurrentException);
    
    if (ErrorContent is not null)
    {
        @ErrorContent(CurrentException)
    }
    else
    {
        <div class="text-danger">An error occured.</div>
    }
}

@code {
    [CascadingParameter] public CircuitBreaker CircuitBreaker { get; set; }
    [Parameter] public bool DisplayTripped { get; set; }
    
    
    public event EventHandler<Exception> OnCaughtException;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        OnCaughtException += TrippedException;
    }

    public virtual void TrippedException(object _, Exception e)
    {
        CircuitBreaker.ProcessError(e);
    }
    
}